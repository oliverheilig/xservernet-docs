<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Add a GeoRSS Layer</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="6b437145-f3ed-4267-a3fc-e71737e6db65" /><meta name="Description" content="This page shows how to add a GeoRSS layer to the map. GeoRSS is a standard for transmitting geo locations via a web feed. Those locations can be shown on the map using a special layer." /><meta name="Microsoft.Help.ContentType" content="Samples" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">PTV xServer .NET<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\9e985ce7-8d43-434f-82bb-260b742553c1.htm" title="PTV xServer .NET" tocid="roottoc">PTV xServer .NET</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/a5bc5d46-5eb8-4b50-be53-1ffa3f7bc7f4.htm" title="How To ..." tocid="a5bc5d46-5eb8-4b50-be53-1ffa3f7bc7f4">How To ...</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5ff21e55-6f37-451d-acae-9321ca31836d.htm" title="XServer Connection" tocid="5ff21e55-6f37-451d-acae-9321ca31836d">XServer Connection</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/714dc4ba-10d3-4a8d-a55d-6210630ff6eb.htm" title="Show Here Satellite View" tocid="714dc4ba-10d3-4a8d-a55d-6210630ff6eb">Show Here Satellite View</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/4926f311-8333-4b18-b509-70c1d876d5eb.htm" title="Show Clusters" tocid="4926f311-8333-4b18-b509-70c1d876d5eb">Show Clusters</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/101dba72-fb36-468b-aa99-4b9c5bbfb62f.htm" title="Add Different Shapes" tocid="101dba72-fb36-468b-aa99-4b9c5bbfb62f">Add Different Shapes</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/e9f559c7-394c-4858-8a40-4744d2fc7200.htm" title="Integrate an additional WPF map" tocid="e9f559c7-394c-4858-8a40-4744d2fc7200">Integrate an additional WPF map</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/6b437145-f3ed-4267-a3fc-e71737e6db65.htm" title="Add a GeoRSS Layer" tocid="6b437145-f3ed-4267-a3fc-e71737e6db65">Add a GeoRSS Layer</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/d705537f-f7fe-435c-bd80-d4d399ee4410.htm" title="Show Map&amp;Market Data" tocid="d705537f-f7fe-435c-bd80-d4d399ee4410">Show Map&amp;Market Data</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/427ab62e-f02d-4e92-9c26-31e0f89d49c5.htm" title="Show a Shape File Content" tocid="427ab62e-f02d-4e92-9c26-31e0f89d49c5">Show a Shape File Content</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/2f6d7ed1-b136-44dc-97c1-3f2c640c2134.htm" title="Add a WMS Layer" tocid="2f6d7ed1-b136-44dc-97c1-3f2c640c2134">Add a WMS Layer</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/fccd9937-aa04-4803-936d-7796cb966963.htm" title="Selection" tocid="fccd9937-aa04-4803-936d-7796cb966963">Selection</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/90fd0772-df3b-473b-a305-6ee939193c7f.htm" title="Apply a UI Theme" tocid="90fd0772-df3b-473b-a305-6ee939193c7f">Apply a UI Theme</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/fe48cb51-c6ce-487e-b4c0-168537c184c3.htm" title="Geocode an Address" tocid="fe48cb51-c6ce-487e-b4c0-168537c184c3">Geocode an Address</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/e7c12cc4-3819-470e-867a-b521bee43cf0.htm" title="Elementary Routing" tocid="e7c12cc4-3819-470e-867a-b521bee43cf0">Elementary Routing</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/e4c416a0-9573-4df8-b733-3bf72539ef0f.htm" title="Drag&amp;Drop Routing" tocid="e4c416a0-9573-4df8-b733-3bf72539ef0f">Drag&amp;Drop Routing</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/34f6b520-454f-4a6a-b0ae-00fc77da512b.htm" title="Tour Planning" tocid="34f6b520-454f-4a6a-b0ae-00fc77da512b">Tour Planning</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/eb8e522c-5ed2-4481-820f-bfd74ee2aeb8.htm" title="Use the Map Gadgets" tocid="eb8e522c-5ed2-4481-820f-bfd74ee2aeb8">Use the Map Gadgets</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/fdaa5363-b092-43cc-950e-6f120dee0d92.htm" title="Set the Map Location" tocid="fdaa5363-b092-43cc-950e-6f120dee0d92">Set the Map Location</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/b55f5d50-a421-4951-bc01-d5fb85c94f54.htm" title="Add an XMapServer Layer" tocid="b55f5d50-a421-4951-bc01-d5fb85c94f54">Add an XMapServer Layer</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/91617b6b-1086-4c05-a1ce-4c64f8bc7dcd.htm" title="Add a Custom Layer" tocid="91617b6b-1086-4c05-a1ce-4c64f8bc7dcd">Add a Custom Layer</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/88521cb3-0770-4f9c-9e47-74b6ea02b6eb.htm" title="Build an ActiveX Control" tocid="88521cb3-0770-4f9c-9e47-74b6ea02b6eb">Build an ActiveX Control</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/1cdf95ec-699c-4d92-bc98-df93503e5a4e.htm" title="Build a C++/MFC application" tocid="1cdf95ec-699c-4d92-bc98-df93503e5a4e">Build a C++/MFC application</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Add a GeoRSS Layer</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p>This page shows how to add a GeoRSS layer to the map. GeoRSS is a standard for transmitting geo locations
      via a web feed. Those locations can be shown on the map using a special layer. </p><p>This page contains the following sections:</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#BasicConcepts">Technical background: GeoRSS</a></li><li class="outlineSectionEntry"><a href="#SectionAddLayer">How to add a new layer for GeoRSS to the map</a></li><li class="outlineSectionEntry"><a href="#SectionParseRSS">How to parse the GeoRSS web feed</a></li><li class="outlineSectionEntry"><a href="#seeAlsoSection">See Also</a></li></ul></div><div class="collapsibleAreaRegion" id="BasicConcepts"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Technical background: GeoRSS</span></div><div id="ID0RBSection" class="collapsibleSection"><p>
          The GeoRSS sample shows how to add a layer showing locations from a web feed to the map. GeoRSS is a standard
          to provide geo locations as part of a web feed. The GeoRSS used in the demo application provides recent
          earthquakes of the World. More information is available here:
          <a href="http://earthquake.usgs.gov/earthquakes/catalogs/" title="Latest Earthquakes: Feeds &amp; Data" target="_blank">Latest Earthquakes: Feeds &amp; Data</a></p></div><div class="collapsibleAreaRegion" id="SectionAddLayer"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />How to add a new layer for GeoRSS to the map</span></div><div id="ID2RBSection" class="collapsibleSection"><p>
          A GeoRSS layer can be added by using a BaseLayer. The following code shows how to create a new base
          layer and initialize it. After that, the layer is added to the map and the map is zoomed to a first reference
          point and reference zoom factor.
        </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EABACAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EABACAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EABACAAA');return false;" title="Copy">Copy</a></div></div><div id="ID1EABACAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">var</span> geoRss = <span class="highlight-keyword">new</span> BaseLayer(<span class="highlight-literal">"GeoRss"</span>)
{
    CanvasCategories = <span class="highlight-keyword">new</span>[] { CanvasCategory.Content },
    CanvasFactories = <span class="highlight-keyword">new</span> BaseLayer.CanvasFactoryDelegate[] { map =&gt; <span class="highlight-keyword">new</span> GeoRssCanvas(map) }
};

<span class="highlight-comment">// Adds the BaseLayer for GeoRss to the WpfMap.</span>
wpfMap.Layers.Add(geoRss);</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EABACAAA");</script><div class="mediaCenter"><img alt="GeoRSS" src="../media/GeoRSS.png" /><div class="caption">GeoRSS use case</div></div></div><div class="collapsibleAreaRegion" id="SectionParseRSS"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />How to parse the GeoRSS web feed</span></div><div id="ID3RBSection" class="collapsibleSection"><p>
          The sample implementation of GeoRssDemo demonstrates the usage of the BaseLayer.CanvasFactories. The XML feed
          needs to be loaded, parsed and have, for example, added pins to the layer (which is derived from
          WorldCanvas in this sample). To get the external geo content, the XML file has to be read. The geo coordinates
          have to be extracted out of the XML file. Then drawing pins in the map we can be started at those coordinates.
          The feed is parsed with <a href="http://msdn.microsoft.com/de-de/library/vstudio/bb397906.aspx" target="_blank">LINQ</a>.
        </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EAAABAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EAAABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EAAABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID1EAAABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-comment">/// &lt;summary&gt; Reads the earthquakes from an xml file and adds a pin element for each to the map. &lt;/summary&gt;</span>
<span class="highlight-keyword">private</span> <span class="highlight-keyword">void</span> ParseAtomUsingLinq()
{
    System.Xml.Linq.XDocument feedXML = System.Xml.Linq.XDocument.Load(<span class="highlight-literal">"http://earthquake.usgs.gov/earthquakes/catalogs/7day-M2.5.xml"</span>);
    System.Xml.Linq.XNamespace xmlns = <span class="highlight-literal">"http://www.w3.org/2005/Atom"</span>; <span class="highlight-comment">//Atom namespace</span>
    System.Xml.Linq.XNamespace georssns = <span class="highlight-literal">"http://www.georss.org/georss"</span>; <span class="highlight-comment">//GeoRSS Namespace</span>

    <span class="highlight-comment">// time to learn some LINQ</span>
    <span class="highlight-keyword">var</span> posts = (<span class="highlight-keyword">from</span> item <span class="highlight-keyword">in</span> feedXML.Descendants(xmlns + <span class="highlight-literal">"entry"</span>)
                 <span class="highlight-keyword">select</span> <span class="highlight-keyword">new</span>
                            {
                                Title = item.Element(xmlns + <span class="highlight-literal">"title"</span>).Value,
                                Published = DateTime.Parse(item.Element(xmlns + <span class="highlight-literal">"updated"</span>).Value),
                                Url = item.Element(xmlns + <span class="highlight-literal">"link"</span>).Attribute(<span class="highlight-literal">"href"</span>).Value,
                                Description = item.Element(xmlns + <span class="highlight-literal">"summary"</span>).Value,
                                Location = CoordinateGeoRssPoint(item.Element(georssns + <span class="highlight-literal">"point"</span>)),
                                <span class="highlight-comment">//Simple GeoRSS &lt;georss:point&gt;X Y&lt;/georss.point&gt;</span>
                            }).ToList();

    <span class="highlight-keyword">int</span> i = <span class="highlight-number">0</span>;
    <span class="highlight-comment">// order posts by latitude, so they overlap nicely on the map</span>
    <span class="highlight-keyword">foreach</span> (<span class="highlight-keyword">var</span> post <span class="highlight-keyword">in</span> <span class="highlight-keyword">from</span> post <span class="highlight-keyword">in</span> posts <span class="highlight-keyword">orderby</span> post.Location.Y <span class="highlight-keyword">descending</span> <span class="highlight-keyword">select</span> post)
    {
        <span class="highlight-keyword">if</span> (!<span class="highlight-keyword">double</span>.IsNaN(post.Location.X) &amp;&amp; !<span class="highlight-keyword">double</span>.IsNaN(post.Location.Y))
        {
            <span class="highlight-comment">// transform wgs to PTVMercator coordinate</span>
            <span class="highlight-keyword">var</span> mapPoint = GeoTransform.WGSToPtvMercator(post.Location);

            <span class="highlight-comment">// create button and set pin template</span>
            <span class="highlight-keyword">var</span> pin = <span class="highlight-keyword">new</span> Pin
                          {
                              <span class="highlight-comment">// a bug in SL throws an obscure exception if children share the same name        </span>
                              <span class="highlight-comment">// http://forums.silverlight.net/forums/t/134299.aspx</span>
                              <span class="highlight-comment">// the name is needed in XAML for data binding, so just create a unique name at runtime</span>
                              Name = <span class="highlight-literal">"pin"</span> + (i++),
                              <span class="highlight-comment">// set render transform for power-law scaling</span>
                              RenderTransform = adjustTransform,
                              <span class="highlight-comment">// scale around lower right</span>
                              RenderTransformOrigin = <span class="highlight-keyword">new</span> System.Windows.Point(<span class="highlight-number">1</span>, <span class="highlight-number">1</span>)
                          };

            <span class="highlight-comment">// set size by magnitude</span>
            <span class="highlight-keyword">double</span> magnitude = MagnitudeFromTitle(post.Title);
            pin.Height = magnitude * <span class="highlight-number">10</span>;
            pin.Width = magnitude * <span class="highlight-number">10</span>;

            <span class="highlight-comment">// calculate a value between 0 and 1 and use it for a blend color</span>
            <span class="highlight-keyword">double</span> relativeDanger = Math.Max(<span class="highlight-number">0</span>, Math.Min(<span class="highlight-number">1</span>, (magnitude - <span class="highlight-number">2.5</span>) / <span class="highlight-number">4</span>));
            pin.Color = Colors.Red;
            pin.Color = ColorBlend.Danger.GetColor((<span class="highlight-keyword">float</span>)relativeDanger);

            <span class="highlight-comment">// set tool tip information</span>
            ToolTipService.SetToolTip(pin, post.Title);

            <span class="highlight-comment">// set position and add to canvas (invert y-ordinate)</span>
            <span class="highlight-comment">// set lower right (pin-tip) as position</span>
            SetLeft(pin, mapPoint.X - pin.Width);
            SetTop(pin, -(mapPoint.Y + pin.Height));
            Children.Add(pin);
        }
    }
}</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EAAABAAA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><a href="http://msdn.microsoft.com/de-de/library/vstudio/bb397906.aspx" target="_blank">LINQ</a></div></div></div></div><div id="pageFooter" class="pageFooter">Visit our website at <a href="http://www.ptvgroup.com">www.ptvgroup.com</a> or browse to <a href="http://xserver.ptvgroup.com">xserver.ptvgroup.com</a> for the latest information on our developer components.<p>Copyright (c) PTV Group, Karlsruhe, Germany.</p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:developer%40ptvgroup.com?Subject=PTV xServer .NET">developer@ptvgroup.com</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>